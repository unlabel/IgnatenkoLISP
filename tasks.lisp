;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;13. Определите функцию, удаляющую в исходном списке все повторные вхождения элементов.;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defun list_to_set(L)
((lambda (x y)
  (cond
   ((null L) nil)
   ((member x y) (list_to_set y))
   (T (cons x (list_to_set y))))) (car L) (cdr L)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;				Тест-кейсы:					;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

list_to_set '(1 1 1 2 2 3 4 1 2 3 4) ; (1 2 3 4)
list_to_set '(12 10 1 2 2 3 42 1 22 31 4 1 4 3) ; (12 10 2 42 22 31 1 4 3)




;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;23. Определите функцию, которая обращает список (а b с) и разбивает его на уровни (((с) b) а).;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defun REVL (L)
 (cond
  ((null L) nil)
  ((null (cdr L)) L)
  (T (list (REVL (cdr L)) (car L)))))
                  
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;				Тест-кейсы:					;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

 REVL '(3 2 1) ; (((1) 2) 3)    
 REVL '(1 2 3 4 2) ; (((((2) 4) 3) 2) 1)              
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;24. Определите функции,осуществляющие преобразования между видами(a b c) и (((а) b) с).;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defun conv-list (lst &optional res)
  (cond ((null lst) (car res))
        (t (conv-list (cdr lst) (list (append res (list (car lst))))))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;				Тест-кейсы:					;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

conv-list '(1 2 3) ; (((1) 2) 3)
 conv-list '(1 2 3 2 1 3) ; ((((((1) 2) 3) 2) 1) 3)
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;28. Определите функцию, вычисляющую, сколько всего атомов в списке (списочной структуре).;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(defun atomcount (x)
(cond ((null x) 0)
      (t  ((lambda (head tail) (cond ((atom head)  (+ 1 (atomcount tail)))
               (t (+ (atomcount head) (atomcount tail)))))
           (car x) (cdr x)))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;				Тест-кейсы:					;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

atomcount '(1 (2 3) 4 7) ; 5           
atomcount '(1 (2 3) 4 (7 5) (1 2 3)) ; 9           
           
           
           
           
           
           
           
           
           
           
           
           
           